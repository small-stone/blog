# 计算机历史和组成

电子计算机出现时间并不长，但人类一直都有计算的需求。公认最早的计算设备是「算盘」

![1646311186963.png](https://img.github.luxe/2022/96ae3633ad37e.png)我记得在我上小学的时候还有算盘的课程。算盘可以存储当前计算状态，这有点类似现在的硬盘系统。算盘的出现主要是因为当前社会发展已经超过人类的心算能力。

随着社会的发展出现了很多计算设备，然而这些都不能称之为「计算机」。最早的 「**computer**」 并不是指计算机，而是一种职业，在英语中，一般 er 结尾的单词通常都是一种职业。「**computer**」最初指的是专门负责计算的人。一直到 1800 年之后才开始慢慢的产生变化。

## 电子计算机

时间进入 19 世纪，世界人口几乎翻倍，人类社会活动对计算的需求越来越高。最开始只是简单的堆叠设备和仪器，于是计算机慢慢发展成了庞然大物，甚至可以占满整个房间。最大的电子计算器是马克 1 号，是用于给盟军的「曼哈顿计划」跑模拟用的（就是美国陆军部研制原子弹计划）。这台设备的大脑是「继电器」，就是一个用电控制的机械开关。

![1646313112885.png](https://img.github.luxe/2022/519698badffec.png)

继电器的结构并不复杂，但是无法做到快速开关，这导致马克 1 号计算三角函数等稍微复杂一点的操作需要的时间长达 1 分钟以上。除此以外继电器更加严重的问题是齿轮磨损。马克 1 号大约有 3500 个继电器，导致设备的维护成本非常高。而且这台巨大的设备会发热，这就会吸引昆虫。1947.9 马克 2 型操作员从一个故障的继电器中拔出了一个死虫。后续我们都管程序的不正确运行叫「bug」,就是虫子的意思。

![1646313707131.png](https://img.github.luxe/2022/715c0d520161e.png)

为了替代问题繁多的继电器，科学家们又发明了「二极管」，再加上控制开关的电极，就成了「三极真空管」。这种设备没有多余的结构而且一秒钟可以开关数千次。因此三极真空管成了电子设备的基础,这标志着计算机从机械转向电子。

第一个大规模应用的计算机是「巨人」，用来在二战时期破解纳粹的通信。1946 年在宾夕法尼亚大学造出了世界上第一台真正通用可编程的电子计算机。它运行十年完成的计算比全人类加起来都要多。1947 年科学家发明了晶体管，全新的计算机时代诞生了。

![1646315746000.png](https://img.github.luxe/2022/c645e4f43b356.png)

晶体管相当复杂，牵扯到量子力学。简单的说就是晶体管有两个电极，中间有一种材料隔开它们。这种材料有时候导电有时候不导电，因此称之为「半导体」。控制线连接到一个「门」电极，通过改变「门」的电荷，可以控制半导体材料的导电性，最终来允许或者不允许电流流动。晶体管的一秒钟可以开关一万次，而且是固态的，体积也非常非常小。这就可以制作更小更便宜的计算机。晶体管的制作材料是「硅」，因此开发和制作的地方就被称为「硅谷」。

## 冯诺依曼模型

在 1945 年冯诺依曼和其他计算机科学家们提出了计算机具体实现的报告，其遵循了图灵机的设计，而且还提出用电子元件构造计算机，并约定了用二进制进行计算和存储。

最重要的是定义计算机基本结构为 5 个部分，分别是**运算器、控制器、存储器、输入设备、输出设备**，这 5 个部分也被称为冯诺依曼模型。

![](https://cdn.jsdelivr.net/gh/xiaolincoder/ImageHost2/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E7%A8%8B%E5%BA%8F%E6%89%A7%E8%A1%8C/%E5%86%AF%E8%AF%BA%E4%BE%9D%E6%9B%BC%E6%A8%A1%E5%9E%8B.png)

运算器、控制器是在中央处理器里的，存储器就我们常见的内存，输入输出设备则是计算机外接的设备，比如键盘就是输入设备，显示器就是输出设备。

### 内存

我们的程序和数据都是存储在内存，存储的区域是线性的。

数据存储的单位是一个二进制位（bit），即 0 或 1。最小的存储单位是字节（byte），1 字节等于 8 位。

内存的地址是从 0 开始编号的，然后自增排列，最后一个地址为内存总字节数 - 1，这种结构好似我们程序里的数组，所以内存的读写任何一个数据的速度都是一样的。

### CPU

32 位和 64 位 CPU 最主要区别在于一次能计算多少字节数据：

- 32 位 CPU 一次可以计算 4 个字节；
- 64 位 CPU 一次可以计算 8 个字节；

这里的 32 位和 64 位，通常称为 CPU 的位宽。

之所以 CPU 要这样设计，是为了能计算更大的数值，如果是 8 位的 CPU，那么一次只能计算 1 个字节，也就是 0~255 范围内的数值。于是为了能一次计算大数的运算，CPU 需要支持多个 byte 一起计算，所以 CPU 位宽越大，可以计算的数值就越大，比如说 32 位 CPU 能计算的最大整数是 `4294967295`。

另外，32 位 CPU 最大只能操作 4GB 内存，就算你装了 8 GB 内存条，也没用。而 64 位 CPU 寻址范围则很大，理论最大的寻址空间为 2^64。

CPU 内部还有一些组件，常见的有**寄存器、控制单元和逻辑运算单元**等。

- 控制单元负责控制 CPU 工作
- 逻辑运算单元负责计算
- 而寄存器可以分为多种类
  - **通用寄存器**，用来存放需要进行运算的数据，比如需要进行加和运算的两个数据。
  - **程序计数器**，用来存储 CPU 要执行下一条指令「所在的内存地址」，注意不是存储了下一条要执行的指令，此时指令还在内存中，程序计数器只是存储了下一条指令的地址。
  - **指令寄存器**，用来存放程序计数器指向的指令，也就是指令本身，指令被执行完成之前，指令都存储在这里。

### 总线

总线是用于 CPU 和内存以及其他设备之间的通信，总线可分为 3 种：

1. 地址总线，用于指定 CPU 将要操作的内存地址；
2. 数据总线，用于读写内存的数据；
3. 控制总线，用于发送和接收信号，比如中断、设备复位等信号，CPU 收到信号后自然进行响应，这时也需要控制总线；

当 CPU 要读写内存数据的时候，一般需要通过两个总线：

- 首先要通过「地址总线」来指定内存的地址；
- 再通过「数据总线」来传输数据；

### 线路位宽

线路传输数据通过操作电压，低电压表示 0，高压电压则表示 1。

如果构造了高低高这样的信号，其实就是 101 二进制数据，如果只有一条线路，就意味着每次只能传递 1 bit 的数据，即 0 或 1，那么传输 101 这个数据，就需要 3 次才能传输完成，这样的效率非常低。

这样一位一位传输的方式，称为串行，下一个 bit 必须等待上一个 bit 传输完成才能进行传输。当然，想一次多传一些数据，增加线路即可，这时数据就可以并行传输。为了避免低效率的串行传输的方式，线路的位宽最好一次就能访问到所有的内存地址。 CPU 要想操作的内存地址就需要地址总线，如果地址总线只有 1 条，那每次只能表示 「0 或 1」这两种情况，所以 CPU 一次只能操作 2 个内存地址，如果想要 CPU 操作 4G 的内存，那么就需要 32 条地址总线，因为 2 ^ 32 = 4G。
